"use strict";(self.webpackChunkada_lang_io=self.webpackChunkada_lang_io||[]).push([[4554],{9661:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>A,contentTitle:()=>f,default:()=>y,frontMatter:()=>h,metadata:()=>k,toc:()=>g});var l=a(1716),n=a(7556),o=a(9464),i=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(e,t,a)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,m=(e,t)=>{for(var a in t||(t={}))p.call(t,a)&&u(e,a,t[a]);if(c)for(var a of c(t))d.call(t,a)&&u(e,a,t[a]);return e};const h={sidebar_position:189},f="H.7 Extensions to Global and Global'Class Aspects",k={unversionedId:"arm/AA-H/AA-H.7",id:"arm/AA-H/AA-H.7",title:"H.7 Extensions to Global and Global'Class Aspects",description:"We're still working on the Reference manual output.  Internal links are broken,",source:"@site/docs/arm/AA-H/AA-H.7.mdx",sourceDirName:"arm/AA-H",slug:"/arm/AA-H/AA-H.7",permalink:"/docs/arm/AA-H/AA-H.7",draft:!1,tags:[],version:"current",sidebarPosition:189,frontMatter:{sidebar_position:189},sidebar:"referenceManualSidebar",previous:{title:"H.6 Pragma Partition_Elaboration_Policy",permalink:"/docs/arm/AA-H/AA-H.6"},next:{title:"Annex J Obsolescent Features",permalink:"/docs/arm/AA-J/"}},A={},g=[{value:"Syntax",id:"syntax",level:4},{value:"Name Resolution Rules",id:"name-resolution-rules",level:4},{value:"Static Semantics",id:"static-semantics",level:4},{value:"Legality Rules",id:"legality-rules",level:4},{value:"Extensions to Ada 2012",id:"extensions-to-ada-2012",level:4},{value:"H.7.1  The Use_Formal and Dispatching Aspects",id:"h71--the-use_formal-and-dispatching-aspects",level:2},{value:"Name Resolution Rules",id:"name-resolution-rules-1",level:4},{value:"Static Semantics",id:"static-semantics-1",level:4},{value:"Legality Rules",id:"legality-rules-1",level:4},{value:"Examples",id:"examples",level:4},{value:"Extensions to Ada 2012",id:"extensions-to-ada-2012-1",level:4}],b={toc:g};function y(e){var t,a=e,{components:i}=a,u=((e,t)=>{var a={};for(var l in e)p.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&c)for(var l of c(e))t.indexOf(l)<0&&d.call(e,l)&&(a[l]=e[l]);return a})(a,["components"]);return(0,l.kt)("wrapper",(t=m(m({},b),u),r(t,s({components:i,mdxType:"MDXLayout"}))),(0,l.kt)("h1",m({},{id:"h7-extensions-to-global-and-globalclass-aspects"}),"H.7 Extensions to Global and Global'Class Aspects"),(0,l.kt)("admonition",m({},{type:"warning"}),(0,l.kt)("p",{parentName:"admonition"},"We're still working on the Reference manual output.  Internal links are broken,\nas are a bunch of other things.\nSee the ",(0,l.kt)("a",m({parentName:"p"},{href:"https://github.com/ada-lang-io/ada-lang-io/issues/20"}),"tracking issue"))),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," In addition to the entities specified in 6.1.2, the Global aspect may be specified for a subtype (including a formal subtype), formal package, formal subprogram, and formal object of an anonymous access-to-subprogram type. "),(0,l.kt)("h4",m({},{id:"syntax"}),"Syntax"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," ","{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," The following additional syntax is provided to override the mode of a formal parameter to reflect indirect effects on variables reachable from the formal parameter by one or more access-value dereferences:"),(0,l.kt)("p",null,(0,l.kt)("code",null,"extended_global_mode"),(0,l.kt)("a",{id:"S0361"}),(0,l.kt)("code",null," ::= "),"    ",(0,l.kt)("strong",null,"overriding")," ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-6/AA-6.1#S0212"},"basic_global_mode"))),(0,l.kt)("h4",m({},{id:"name-resolution-rules"}),"Name Resolution Rules"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," The ",(0,l.kt)("em",null,"object_"),(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name"))," that is associated with an ",(0,l.kt)("strong",null,"overriding")," mode shall resolve to statically denote a formal object, or a formal parameter of the associated entity. "),(0,l.kt)("h4",m({},{id:"static-semantics"}),"Static Semantics"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," The presence of the reserved word ",(0,l.kt)("strong",null,"overriding")," in a global mode indicates that the specification is overriding the mode of a formal parameter with another mode to reflect the overall effect of an invocation of the callable entity on the state associated with the corresponding actual parameter."),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," [As described in 6.1.2, the following rules are defined in terms of operations that are performed by or on behalf of an entity.]"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," ","{",(0,l.kt)("em",null,"AI12-0431-1"),"}"," ","{",(0,l.kt)("em",null,"AI12-0439-1"),"}"," The Global aspect for a subtype identifies the global variables that can be referenced during default initialization, adjustment as part of assignment, finalization of an object of the subtype, or conversion to the subtype, including the evaluation of any assertion expressions that apply. If not specified for the first subtype of a derived type, the aspect defaults to that of the ancestor subtype; if not specified for a nonderived composite first subtype the aspect defaults to that of the enclosing library unit; if not specified for a nonderived elementary first subtype (or scalar base subtype), the aspect defaults to ",(0,l.kt)("strong",null,"null")," in the absence of a predicate (or when the predicate is statically True), and to that of the enclosing library unit otherwise. If not specified for a nonfirst subtype ",(0,l.kt)("em",null,"S"),", the Global aspect defaults to that of the subtype identified in the ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-3/AA-3.2#S0027"},"subtype_indication"))," defining ",(0,l.kt)("em",null,"S"),"."),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," The Global'Class aspect may be specified for the first subtype of a tagged type ",(0,l.kt)("em",null,"T"),", indicating an upper bound on the Global aspect of any descendant of ",(0,l.kt)("em",null,"T"),". If not specified, it defaults to Unspecified. "),(0,l.kt)("h4",m({},{id:"legality-rules"}),"Legality Rules"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," For a tagged subtype ",(0,l.kt)("em",null,"T"),", each mode of its Global aspect shall identify a subset of the variables identified either by the corresponding mode, or by the ",(0,l.kt)("strong",null,"in out")," mode, of the Global'Class aspect of the first subtype of any ancestor of ",(0,l.kt)("em",null,"T"),". "),(0,l.kt)("h4",m({},{id:"extensions-to-ada-2012"}),"Extensions to Ada 2012"),(0,l.kt)(o.Z,{type:"note",mdxType:"Admonition"},(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," ","{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," These extensions to the Global aspect are new. ")),(0,l.kt)("h2",m({},{id:"h71--the-use_formal-and-dispatching-aspects"}),"H.7.1  The Use_Formal and Dispatching Aspects"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," The Use_Formal and Dispatching aspects are provided to more precisely describe the use of generic formal parameters and dispatching calls within the execution of an operation, enabling more precise checking of conformance with the Nonblocking and global aspects that apply at the point of invocation of the operation."),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," ","{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," For any declaration within a generic unit for which a global or Nonblocking aspect may be specified, other than a ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-12/AA-12.1#S0314"},"generic_formal_parameter_declaration")),", the following aspect may be specified to indicate which generic formal parameters are ",(0,l.kt)("em",null,"used")," by the associated entity:"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," Use_FormalThe aspect is specified with a ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0362"},"formal_parameter_set")),", with the following form:"),(0,l.kt)(o.Z,{type:"note",mdxType:"Admonition"},(0,l.kt)("p",null,(0,l.kt)("strong",null,"Aspect Description for "),(0,l.kt)("strong",null,"Use_Formal: "),"Generic formal parameters used in the implementation of an entity.")),(0,l.kt)("p",null,(0,l.kt)("code",null,"formal_parameter_set"),(0,l.kt)("a",{id:"S0362"}),(0,l.kt)("code",null," ::= "),"    ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0363"},"formal_group_designator")),"  | ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0364"},"formal_parameter_name")),"  | (",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0364"},"formal_parameter_name")),"{",", ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0364"},"formal_parameter_name")),"}",")"),(0,l.kt)("p",null,(0,l.kt)("code",null,"formal_group_designator"),(0,l.kt)("a",{id:"S0363"}),(0,l.kt)("code",null," ::= "),(0,l.kt)("strong",null,"null")," | ",(0,l.kt)("strong",null,"all")),(0,l.kt)("p",null,(0,l.kt)("code",null,"formal_parameter_name"),(0,l.kt)("a",{id:"S0364"}),(0,l.kt)("code",null," ::= "),"    ",(0,l.kt)("em",null,"formal_"),(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-3/AA-3.2#S0028"},"subtype_mark")),"  | ",(0,l.kt)("em",null,"formal_subprogram_"),(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name")),"  | ",(0,l.kt)("em",null,"formal_access_to_subprogram_object_"),(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name"))),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," ","{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," For any declaration for which a global or Nonblocking aspect may be specified, other than for a library package, a generic library package, or a generic formal, the following aspect may be specified:"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," Dispatching The aspect is specified with a ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0365"},"dispatching_operation_set")),", with the following form:"),(0,l.kt)(o.Z,{type:"note",mdxType:"Admonition"},(0,l.kt)("p",null,(0,l.kt)("strong",null,"Aspect Description for "),(0,l.kt)("strong",null,"Dispatching: "),"Generic formal parameters used in the implementation of an entity.")),(0,l.kt)("p",null,(0,l.kt)("code",null,"dispatching_operation_set"),(0,l.kt)("a",{id:"S0365"}),(0,l.kt)("code",null," ::= "),"    ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier")),"  | (",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier")),"{",", ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier")),"}",")"),(0,l.kt)("p",null,(0,l.kt)("code",null,"dispatching_operation_specifier"),(0,l.kt)("a",{id:"S0366"}),(0,l.kt)("code",null," ::= "),"    ",(0,l.kt)("em",null,"dispatching_operation_"),(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name"))," (",(0,l.kt)("em",null,"object_"),(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name")),")"),(0,l.kt)("h4",m({},{id:"name-resolution-rules-1"}),"Name Resolution Rules"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," A ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0364"},"formal_parameter_name"))," in a Use_Formal aspect shall resolve to statically denote a formal subtype, a formal subprogram, or a formal object of an anonymous access-to-subprogram type[ of an enclosing generic unit or visible formal package]."),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," The ",(0,l.kt)("em",null,"object_"),(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name"))," of a ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier"))," shall resolve to statically name an object (including possibly a formal parameter) of a tagged class-wide type ",(0,l.kt)("em",null,"T"),"'Class, or of an access type designating a tagged class-wide type ",(0,l.kt)("em",null,"T"),"'Class; the ",(0,l.kt)("em",null,"dispatching_operation_"),(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name"))," of the ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier"))," shall resolve to statically denote a dispatching operation associated with ",(0,l.kt)("em",null,"T"),". "),(0,l.kt)("h4",m({},{id:"static-semantics-1"}),"Static Semantics"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," ","{",(0,l.kt)("em",null,"AI12-0439-1"),"}"," The ",(0,l.kt)("em",null,"formal parameter set")," is identified by a set of ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0364"},"formal_parameter_name")),"s. Alternatively, the reserved word ",(0,l.kt)("strong",null,"null")," may be used to indicate none of the generic formal parameters, or ",(0,l.kt)("strong",null,"all")," to indicate all of the generic formal parameters, of any enclosing generic unit (or visible formal package) can be used within the execution of the operation. If there is no formal parameter set specified for an entity declared within a generic unit, it defaults to ",(0,l.kt)("strong",null,"all"),"."),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," ","{",(0,l.kt)("em",null,"AI12-0404-1"),"}"," ","{",(0,l.kt)("em",null,"AI12-0444-1"),"}"," The ",(0,l.kt)("em",null,"dispatching operation set")," is identified by a set of ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier")),"s. It indicates that the Nonblocking and global effects of dispatching calls that match one of the specifiers, rather than being accounted for by the Nonblocking or global aspect, are instead to be accounted for by the invoker of the operation. A dispatching call matches a ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier"))," if the ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name"))," or ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0093"},"prefix"))," of the call statically denotes the same operation(s) as that of the ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier")),", and at least one of the objects controlling the call is denoted by, or designated by, a ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name"))," that statically names the same object as that denoted by the ",(0,l.kt)("em",null,"object_"),(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-4/AA-4.1#S0091"},"name"))," of the ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier")),"."),(0,l.kt)(o.Z,{type:"note",mdxType:"Admonition"},(0,l.kt)("p",null,(0,l.kt)("strong",null,"Ramification: "),'The object "controlling the call" is not necessarily a controlling parameter of the call if the call is a function with a controlling result or has parameters that is such a function. It is one of the objects that provide the dispatching tag used for the call; that could, for example, be a parameter of a function used as a parameter to the call, or an object being assigned to, or a parameter of an enclosing call. ')),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," ","{",(0,l.kt)("em",null,"AI12-0404-1"),"}"," In the absence of any ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier")),"s, or if none of them match a dispatching call ",(0,l.kt)("em",null,"C")," within an operation ",(0,l.kt)("em",null,"P"),", Nonblocking and global aspects checks are performed at the point of the call ",(0,l.kt)("em",null,"C")," within ",(0,l.kt)("em",null,"P")," using the Nonblocking and Global'Class aspects that apply to the dispatching operation named in call ",(0,l.kt)("em",null,"C"),". If there is a match, any global access or potential blocking within the subprogram body invoked by the call ",(0,l.kt)("em",null,"C")," is ignored at the point of call within ",(0,l.kt)("em",null,"P"),". Instead, when the operation ",(0,l.kt)("em",null,"P")," itself is invoked, Nonblocking and global aspect checks are performed presuming each named dispatching operation is called at least once (with the named object controlling the call), but similarly ignoring those dispatching calls that would match a ",(0,l.kt)("code",null,(0,l.kt)("a",{href:"../AA-H/AA-H.7#S0366"},"dispatching_operation_specifier"))," applicable at the point of invocation of ",(0,l.kt)("em",null,"P"),"."),(0,l.kt)("h4",m({},{id:"legality-rules-1"}),"Legality Rules"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," Within an operation to which a Use_Formal aspect applies, if the formal parameter set is anything but ",(0,l.kt)("strong",null,"all"),", then the only generic formal subtypes that may be used, the only formal subprograms that may be called, and the only formal objects of an anonymous access-to-subprogram type that may be dereferenced as part of a call or passed as the actual for an access parameter, are those included in the formal parameter set."),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0380-1"),"}"," When an operation (or instance thereof) to which a Use_Formal aspect applies is invoked, Nonblocking and global aspect checks are performed presuming each generic formal parameter (or corresponding actual parameter) of the formal parameter set is used at least once. "),(0,l.kt)("h4",m({},{id:"examples"}),"Examples"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0430-1"),"}"," ",(0,l.kt)("em",null,"An example of use of the Dispatching aspect:")," "),(0,l.kt)(n.Z,{mdxType:"CodeBlock"},"procedure My_Write(  --  see 13.13.2","\n","   Stream : not null access Ada.Streams.Root_Stream_Type'Class;","\n","   Item   : My_Integer'Base)","\n","   with Dispatching =",">"," Write(Stream);","\n","for My_Integer'Write use My_Write;","\n"),(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0430-1"),"}"," ",(0,l.kt)("em",null,"For examples of use of the Use_Formal aspect, see the Element functions of Hashed_Sets in A.18.8.")),(0,l.kt)("h4",m({},{id:"extensions-to-ada-2012-1"}),"Extensions to Ada 2012"),(0,l.kt)(o.Z,{type:"note",mdxType:"Admonition"},(0,l.kt)("p",null,"{",(0,l.kt)("em",null,"AI12-0079-3"),"}"," The aspects Use_Formal and Dispatching are new. ")))}y.isMDXComponent=!0}}]);
"use strict";(self.webpackChunkada_lang_io=self.webpackChunkada_lang_io||[]).push([[4655],{1943:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>m,contentTitle:()=>h,default:()=>b,frontMatter:()=>p,metadata:()=>f,toc:()=>A});var n=t(1716),o=t(7556),l=Object.defineProperty,i=Object.defineProperties,r=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(e,a,t)=>a in e?l(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,k=(e,a)=>{for(var t in a||(a={}))s.call(a,t)&&u(e,t,a[t]);if(c)for(var t of c(a))d.call(a,t)&&u(e,t,a[t]);return e};const p={sidebar_position:59},h="7.2  Package Bodies",f={unversionedId:"arm/AA-7.2",id:"arm/AA-7.2",title:"7.2  Package Bodies",description:"We're still working on the Reference manual output.  Internal links are broken,",source:"@site/docs/arm/AA-7.2.mdx",sourceDirName:"arm",slug:"/arm/AA-7.2",permalink:"/docs/arm/AA-7.2",draft:!1,tags:[],version:"current",sidebarPosition:59,frontMatter:{sidebar_position:59},sidebar:"tutorialSidebar",previous:{title:"7.1  Package Specifications and Declarations",permalink:"/docs/arm/AA-7.1"},next:{title:"7.3  Private Types and Private Extensions",permalink:"/docs/arm/AA-7.3"}},m={},A=[{value:"Syntax",id:"syntax",level:4},{value:"Legality Rules",id:"legality-rules",level:4},{value:"Static Semantics",id:"static-semantics",level:4},{value:"Dynamic Semantics",id:"dynamic-semantics",level:4},{value:"Examples",id:"examples",level:4},{value:"Wording Changes from Ada 83",id:"wording-changes-from-ada-83",level:4},{value:"Extensions to Ada 2005",id:"extensions-to-ada-2005",level:4}],g={toc:A};function b(e){var a,t=e,{components:l}=t,u=((e,a)=>{var t={};for(var n in e)s.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&c)for(var n of c(e))a.indexOf(n)<0&&d.call(e,n)&&(t[n]=e[n]);return t})(t,["components"]);return(0,n.kt)("wrapper",(a=k(k({},g),u),i(a,r({components:l,mdxType:"MDXLayout"}))),(0,n.kt)("h1",k({},{id:"72--package-bodies"}),"7.2  Package Bodies"),(0,n.kt)("admonition",k({},{type:"warning"}),(0,n.kt)("p",{parentName:"admonition"},"We're still working on the Reference manual output.  Internal links are broken,\nas are a bunch of other things.\nSee the ",(0,n.kt)("a",k({parentName:"p"},{href:"https://github.com/ada-lang-io/ada-lang-io/issues/20"}),"tracking issue"))),(0,n.kt)("p",null,"[In contrast to the entities declared in the visible part of a package, the entities declared in the ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," are visible only within the ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," itself. As a consequence, a package with a ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," can be used for the construction of a group of related subprograms in which the logical operations available to clients are clearly isolated from the internal entities.] "),(0,n.kt)("h4",k({},{id:"syntax"}),"Syntax"),(0,n.kt)("p",null,"{",(0,n.kt)("em",null,"AI05-0267-1"),"}"," ",(0,n.kt)("code",null,"package_body"),(0,n.kt)("a",{id:"S0231"}),(0,n.kt)("code",null," ::= "),"    ",(0,n.kt)("strong",null,"package")," ",(0,n.kt)("strong",null,"body")," ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-6.1#S0201"},"defining_program_unit_name")),"        [",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-13.1#S0346"},"aspect_specification")),"] ",(0,n.kt)("strong",null,"is"),"       ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-3.11#S0086"},"declarative_part")),"   [",(0,n.kt)("strong",null,"begin"),"        ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-11.2#S0304"},"handled_sequence_of_statements")),"]    ",(0,n.kt)("strong",null,"end")," [[",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-10.1#S0291"},"parent_unit_name")),".]",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-2.3#S0002"},"identifier")),"];"),(0,n.kt)("p",null,"If an ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-2.3#S0002"},"identifier"))," or ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-10.1#S0291"},"parent_unit_name")),".",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-2.3#S0002"},"identifier"))," appears at the end of a ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body")),", then this sequence of lexical elements shall repeat the ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-6.1#S0201"},"defining_program_unit_name")),". "),(0,n.kt)("h4",k({},{id:"legality-rules"}),"Legality Rules"),(0,n.kt)("p",null,"{",(0,n.kt)("em",null,"AI12-0417-1"),"}"," A ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," shall be the completion of a previous ",(0,n.kt)("code",null,"[package_declaration](./AA-7.1#S0229)")," or ",(0,n.kt)("code",null,"[generic_package_declaration](./AA-12.1#S0312)"),". A library ",(0,n.kt)("code",null,"[package_declaration](./AA-7.1#S0229)")," or library ",(0,n.kt)("code",null,"[generic_package_declaration](./AA-12.1#S0312)")," shall not have a body unless it requires a body[; the Elaborate_Body aspect can be used to require a ",(0,n.kt)("code",null,"[library_unit_declaration](./AA-10.1#S0288)")," to have a body (see 10.2.1) if it would not otherwise require one]. "),(0,n.kt)("p",null,(0,n.kt)("strong",null,"Ramification: "),"The first part of the rule forbids a ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," from standing alone - it has to belong to some previous ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.1#S0229"},"package_declaration"))," or ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-12.1#S0312"},"generic_package_declaration")),"."),(0,n.kt)("p",null,"A nonlibrary ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.1#S0229"},"package_declaration"))," or nonlibrary ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-12.1#S0312"},"generic_package_declaration"))," that does not require a completion may have a corresponding body anyway. "),(0,n.kt)("h4",k({},{id:"static-semantics"}),"Static Semantics"),(0,n.kt)("p",null,"{",(0,n.kt)("em",null,"AI05-0299-1"),"}"," In any ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," without ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-5.1#S0167"},"statement")),"s there is an implicit ",(0,n.kt)("code",null,"[null_statement](./AA-5.1#S0170)"),". For any ",(0,n.kt)("code",null,"[package_declaration](./AA-7.1#S0229)")," without an explicit completion, there is an implicit ",(0,n.kt)("code",null,"[package_body](./AA-7.2#S0231)")," containing a single ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-5.1#S0170"},"null_statement")),". For a noninstance, nonlibrary package, this body occurs at the end of the ",(0,n.kt)("code",null,"[declarative_part](./AA-3.11#S0086)")," of the innermost enclosing program unit or ",(0,n.kt)("code",null,"[block_statement](./AA-5.6#S0191)"),"; if there are several such packages, the order of the implicit ",(0,n.kt)("code",null,"package_bodies")," is unspecified. [(For an instance, the implicit ",(0,n.kt)("code",null,"[package_body](./AA-7.2#S0231)")," occurs at the place of the instantiation (see 12.3). For a library package, the place is partially determined by the elaboration dependences (see Clause 10).)] "),(0,n.kt)("p",null,(0,n.kt)("strong",null,"Discussion: "),"Thus, for example, we can refer to something happening just after the ",(0,n.kt)("strong",null,"begin")," of a ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body")),", and we can refer to the ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-11.2#S0304"},"handled_sequence_of_statements"))," of a ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body")),", without worrying about all the optional pieces. The place of the implicit body makes a difference for tasks activated by the package. See also RM83-9.3(5)."),(0,n.kt)("p",null,"The implicit body would be illegal if explicit in the case of a library package that does not require (and therefore does not allow) a body. This is a bit strange, but not harmful. "),(0,n.kt)("h4",k({},{id:"dynamic-semantics"}),"Dynamic Semantics"),(0,n.kt)("p",null,"For the elaboration of a nongeneric ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body")),", its ",(0,n.kt)("code",null,"[declarative_part](./AA-3.11#S0086)")," is first elaborated, and its ",(0,n.kt)("code",null,"[handled_sequence_of_statements](./AA-11.2#S0304)")," is then executed. "),(0,n.kt)("p",null,"NOTE 1   A variable declared in the body of a package is only visible within this body and, consequently, its value can only be changed within the ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body")),'. In the absence of local tasks, the value of such a variable remains unchanged between calls issued from outside the package to subprograms declared in the visible part. The properties of such a variable are similar to those of a "static" variable of C.'),(0,n.kt)("p",null,"NOTE 2   The elaboration of the body of a subprogram explicitly declared in the visible part of a package is caused by the elaboration of the body of the package. Hence a call of such a subprogram by an outside program unit raises the exception Program_Error if the call takes place before the elaboration of the ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," (see 3.11). "),(0,n.kt)("h4",k({},{id:"examples"}),"Examples"),(0,n.kt)("p",null,(0,n.kt)("em",null,"Example of a package body (see 7.1):")," "),(0,n.kt)(o.Z,{mdxType:"CodeBlock"},"package body Rational_Numbers is","\n"),(0,n.kt)(o.Z,{mdxType:"CodeBlock"},"procedure Same_Denominator (X,Y : in out Rational) is","\n","   begin","\n","      --  reduces X and Y to the same denominator:","\n","      ...","\n","   end Same_Denominator;","\n"),(0,n.kt)(o.Z,{mdxType:"CodeBlock"},'function "="(X,Y : Rational) return Boolean is',"\n","      U : Rational := X;","\n","      V : Rational := Y;","\n","   begin","\n","      Same_Denominator (U,V);","\n","      return U.Numerator = V.Numerator;","\n",'   end "=";',"\n"),(0,n.kt)(o.Z,{mdxType:"CodeBlock"},'function "/" (X,Y : Integer) return Rational is',"\n","   begin","\n","      if Y ",">"," 0 then","\n","         return (Numerator =",">"," X,  Denominator =",">"," Y);","\n","      else","\n","         return (Numerator =",">"," -X, Denominator =",">"," -Y);","\n","      end if;","\n",'   end "/";',"\n"),(0,n.kt)(o.Z,{mdxType:"CodeBlock"},'function "+" (X,Y : Rational) return Rational is ... end "+";',"\n",'   function "-" (X,Y : Rational) return Rational is ... end "-";',"\n",'   function "*" (X,Y : Rational) return Rational is ... end "*";',"\n",'   function "/" (X,Y : Rational) return Rational is ... end "/";',"\n"),(0,n.kt)(o.Z,{mdxType:"CodeBlock"},"end Rational_Numbers;","\n"),(0,n.kt)("h4",k({},{id:"wording-changes-from-ada-83"}),"Wording Changes from Ada 83"),(0,n.kt)("p",null,"The syntax rule for ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," now uses the syntactic category ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-11.2#S0304"},"handled_sequence_of_statements")),"."),(0,n.kt)("p",null,"The ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-3.11#S0086"},"declarative_part"))," of a ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," is now required; that doesn't make any real difference, since a ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-3.11#S0086"},"declarative_part"))," can be empty."),(0,n.kt)("p",null,"RM83 seems to have forgotten to say that a ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body"))," can't stand alone, without a previous declaration. We state that rule here."),(0,n.kt)("p",null,"RM83 forgot to restrict the definition of elaboration of ",(0,n.kt)("code",null,"package_bodies")," to nongeneric ones. We have corrected that omission."),(0,n.kt)("p",null,"The rule about implicit bodies (from RM83-9.3(5)) is moved here, since it is more generally applicable. "),(0,n.kt)("h4",k({},{id:"extensions-to-ada-2005"}),"Extensions to Ada 2005"),(0,n.kt)("p",null,"{",(0,n.kt)("em",null,"AI05-0267-1"),"}"," An optional ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-13.1#S0346"},"aspect_specification"))," can be used in a ",(0,n.kt)("code",null,(0,n.kt)("a",{href:"./AA-7.2#S0231"},"package_body")),". This is described in 13.1.1. "))}b.isMDXComponent=!0}}]);
"use strict";(self.webpackChunkada_lang_io=self.webpackChunkada_lang_io||[]).push([[8234],{1716:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var i=n(6687);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),m=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=m(e.components);return i.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=m(n),h=a,d=p["".concat(l,".").concat(h)]||p[h]||c[h]||o;return n?i.createElement(d,r(r({ref:t},u),{},{components:n})):i.createElement(d,r({ref:t},u))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var m=2;m<o;m++)r[m]=n[m];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}p.displayName="MDXCreateElement"},6660:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>m});var i=n(9440),a=(n(6687),n(1716));const o={sidebar_position:159},r="D.8  Monotonic Time",s={unversionedId:"arm/AA-D.8",id:"arm/AA-D.8",title:"D.8  Monotonic Time",description:"[This subclause specifies a high-resolution, monotonic clock package.]",source:"@site/docs/arm/AA-D.8.md",sourceDirName:"arm",slug:"/arm/AA-D.8",permalink:"/docs/arm/AA-D.8",draft:!1,tags:[],version:"current",sidebarPosition:159,frontMatter:{sidebar_position:159},sidebar:"tutorialSidebar",previous:{title:"D.7  Tasking Restrictions",permalink:"/docs/arm/AA-D.7"},next:{title:"D.9  Delay Accuracy",permalink:"/docs/arm/AA-D.9"}},l={},m=[{value:"Static Semantics",id:"static-semantics",level:4},{value:"Dynamic Semantics",id:"dynamic-semantics",level:4},{value:"Implementation Requirements",id:"implementation-requirements",level:4},{value:"Documentation Requirements",id:"documentation-requirements",level:4},{value:"Metrics",id:"metrics",level:4},{value:"Implementation Permissions",id:"implementation-permissions",level:4},{value:"Implementation Advice",id:"implementation-advice",level:4},{value:"Incompatibilities With Ada 95",id:"incompatibilities-with-ada-95",level:4},{value:"Wording Changes from Ada 95",id:"wording-changes-from-ada-95",level:4}],u={toc:m};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"d8--monotonic-time"},"D.8  Monotonic Time"),(0,a.kt)("p",null,"{AI05-0299-1} ","[This subclause specifies a high-resolution, monotonic clock package.]"," "),(0,a.kt)("h4",{id:"static-semantics"},"Static Semantics"),(0,a.kt)("p",null,"The following language-defined library package exists: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"{AI12-0241-1} {AI12-0302-1} package Ada.Real_Time\n  with Nonblocking, Global =&gt in out synchronized is\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"  type Time is private;\n  Time_First : constant Time;\n  Time_Last : constant Time;\n  Time_Unit : constant := implementation-defined-real-number;\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"  type Time_Span is private;\n  Time_Span_First : constant Time_Span;\n  Time_Span_Last : constant Time_Span;\n  Time_Span_Zero : constant Time_Span;\n  Time_Span_Unit : constant Time_Span;\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"  Tick : constant Time_Span;\n  function Clock return Time;\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},'  function "+" (Left : Time; Right : Time_Span) return Time;\n  function "+" (Left : Time_Span; Right : Time) return Time;\n  function "-" (Left : Time; Right : Time_Span) return Time;\n  function "-" (Left : Time; Right : Time) return Time_Span;\n\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},'  function "&lt" (Left, Right : Time) return Boolean;\n  function "&lt="(Left, Right : Time) return Boolean;\n  function "&gt" (Left, Right : Time) return Boolean;\n  function "&gt="(Left, Right : Time) return Boolean;\n\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},'  function "+" (Left, Right : Time_Span) return Time_Span;\n  function "-" (Left, Right : Time_Span) return Time_Span;\n  function "-" (Right : Time_Span) return Time_Span;\n  function "*" (Left : Time_Span; Right : Integer) return Time_Span;\n  function "*" (Left : Integer; Right : Time_Span) return Time_Span;\n  function "/" (Left, Right : Time_Span) return Integer;\n  function "/" (Left : Time_Span; Right : Integer) return Time_Span;\n\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},'  function "abs"(Right : Time_Span) return Time_Span;\n\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"This paragraph was deleted.\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},'  function "&lt" (Left, Right : Time_Span) return Boolean;\n  function "&lt="(Left, Right : Time_Span) return Boolean;\n  function "&gt" (Left, Right : Time_Span) return Boolean;\n  function "&gt="(Left, Right : Time_Span) return Boolean;\n\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"  function To_Duration (TS : Time_Span) return Duration;\n  function To_Time_Span (D : Duration) return Time_Span;\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"{AI95-00386-01}   function Nanoseconds  (NS : Integer) return Time_Span;\n  function Microseconds (US : Integer) return Time_Span;\n  function Milliseconds (MS : Integer) return Time_Span;\n  function Seconds      (S  : Integer) return Time_Span;\n  function Minutes      (M  : Integer) return Time_Span;\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"  type Seconds_Count is range implementation-defined;\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"  procedure Split(T : in Time; SC : out Seconds_Count; TS : out Time_Span);\n  function Time_Of(SC : Seconds_Count; TS : Time_Span) return Time;\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ada"},"private\n   ... -- not specified by the language\nend Ada.Real_Time;\n\n")),(0,a.kt)("p",null,"This paragraph was deleted."),(0,a.kt)("p",null,"In this Annex, real time is defined to be the physical time as observed in the external environment. The type Time is a time type as defined by 9.6; [values of this type may be used in a ",(0,a.kt)("a",{parentName:"p",href:"./AA-9.6#S0267"},"delay_until_statement"),".] Values of this type represent segments of an ideal time line. The set of values of the type Time corresponds one-to-one with an implementation-defined range of mathematical integers. "),(0,a.kt)("p",null,"Discussion: Informally, real time is defined to be the International Atomic Time (TAI) which is monotonic and nondecreasing. We use it here for the purpose of discussing rate of change and monotonic behavior only. It does not imply anything about the absolute value of Real_Time.Clock, or about Real_Time.Time being synchronized with TAI. It is also used for real time in the metrics, for comparison purposes. "),(0,a.kt)("p",null,'Implementation Note: The specification of TAI as "real time" does not preclude the use of a simulated TAI clock for simulated execution environments. '),(0,a.kt)("p",null,"The Time value I represents the half-open real time interval that starts with E+I",(0,a.kt)("em",{parentName:"p"},"Time_Unit and is limited by E+(I+1)"),"Time_Unit, where Time_Unit is an implementation-defined real number and E is an unspecified origin point, the epoch, that is the same for all values of the type Time. It is not specified by the language whether the time values are synchronized with any standard time reference. ","[For example, E can correspond to the time of system initialization or it can correspond to the epoch of some time standard.]"," "),(0,a.kt)("p",null,"Discussion: E itself does not have to be a proper time value."),(0,a.kt)("p",null,"This half-open interval I consists of all real numbers R such that E+I",(0,a.kt)("em",{parentName:"p"},"Time_Unit ","<","= R ","<"," E+(I+1)"),"Time_Unit. "),(0,a.kt)("p",null,"Values of the type Time_Span represent length of real time duration. The set of values of this type corresponds one-to-one with an implementation-defined range of mathematical integers. The Time_Span value corresponding to the integer I represents the real-time duration I*Time_Unit. "),(0,a.kt)("p",null,"Reason: The purpose of this type is similar to Standard.Duration; the idea is to have a type with a higher resolution. "),(0,a.kt)("p",null,"Discussion: We looked at many possible names for this type: Real_Time.Duration, Fine_Duration, Interval, Time_Interval_Length, Time_Measure, and more. Each of these names had some problems, and we've finally settled for Time_Span. "),(0,a.kt)("p",null,"Time_First and Time_Last are the smallest and largest values of the Time type, respectively. Similarly, Time_Span_First and Time_Span_Last are the smallest and largest values of the Time_Span type, respectively."),(0,a.kt)("p",null,"A value of type Seconds_Count represents an elapsed time, measured in seconds, since the epoch."),(0,a.kt)("h4",{id:"dynamic-semantics"},"Dynamic Semantics"),(0,a.kt)("p",null,"Time_Unit is the smallest amount of real time representable by the Time type; it is expressed in seconds. Time_Span_Unit is the difference between two successive values of the Time type. It is also the smallest positive value of type Time_Span. Time_Unit and Time_Span_Unit represent the same real time duration. A clock tick is a real time interval during which the clock value (as observed by calling the Clock function) remains constant. Tick is the average length of such intervals."),(0,a.kt)("p",null,"{AI95-00432-01} The function To_Duration converts the value TS to a value of type Duration. Similarly, the function To_Time_Span converts the value D to a value of type Time_Span. For To_Duration, the result is rounded to the nearest value of type Duration (away from zero if exactly halfway between two values). If the result is outside the range of Duration, Constraint_Error is raised. For To_Time_Span, the value of D is first rounded to the nearest integral multiple of Time_Unit, away from zero if exactly halfway between two multiples. If the rounded value is outside the range of Time_Span, Constraint_Error is raised. Otherwise, the value is converted to the type Time_Span."),(0,a.kt)("p",null,"To_Duration(Time_Span_Zero) returns 0.0, and To_Time_Span(0.0) returns Time_Span_Zero."),(0,a.kt)("p",null,"{AI95-00386-01} {AI95-00432-01} The functions Nanoseconds, Microseconds, Milliseconds, Seconds, and Minutes convert the input parameter to a value of the type Time_Span. NS, US, MS, S, and M are interpreted as a number of nanoseconds, microseconds, milliseconds, seconds, and minutes respectively. The input parameter is first converted to seconds and rounded to the nearest integral multiple of Time_Unit, away from zero if exactly halfway between two multiples. If the rounded value is outside the range of Time_Span, Constraint_Error is raised. Otherwise, the rounded value is converted to the type Time_Span. "),(0,a.kt)("p",null,"This paragraph was deleted.{AI95-00432-01} "),(0,a.kt)("p",null,"The effects of the operators on Time and Time_Span are as for the operators defined for integer types. "),(0,a.kt)("p",null,"Implementation Note: Though time values are modeled by integers, the types Time and Time_Span need not be implemented as integers. "),(0,a.kt)("p",null,"The function Clock returns the amount of time since the epoch."),(0,a.kt)("p",null,"The effects of the Split and Time_Of operations are defined as follows, treating values of type Time, Time_Span, and Seconds_Count as mathematical integers. The effect of Split(T,SC,TS) is to set SC and TS to values such that T",(0,a.kt)("em",{parentName:"p"},"Time_Unit = SC"),"1.0 + TS",(0,a.kt)("em",{parentName:"p"},"Time_Unit, and 0.0 ","<","= TS"),"Time_Unit ","<"," 1.0. The value returned by Time_Of(SC,TS) is the value T such that T",(0,a.kt)("em",{parentName:"p"},"Time_Unit = SC"),"1.0 + TS*Time_Unit. "),(0,a.kt)("h4",{id:"implementation-requirements"},"Implementation Requirements"),(0,a.kt)("p",null,"The range of Time values shall be sufficient to uniquely represent the range of real times from program start-up to 50 years later. Tick shall be no greater than 1 millisecond. Time_Unit shall be less than or equal to 20 microseconds. "),(0,a.kt)("p",null,"Implementation Note: The required range and accuracy of Time are such that 32-bits worth of seconds and 32-bits worth of ticks in a second could be used as the representation. "),(0,a.kt)("p",null,"Time_Span_First shall be no greater than 3600 seconds, and Time_Span_Last shall be no less than 3600 seconds. "),(0,a.kt)("p",null,"Reason: This is equivalent to \ufffd one hour and there is still room for a two-microsecond resolution. "),(0,a.kt)("p",null,"A clock jump is the difference between two successive distinct values of the clock (as observed by calling the Clock function). There shall be no backward clock jumps."),(0,a.kt)("h4",{id:"documentation-requirements"},"Documentation Requirements"),(0,a.kt)("p",null,"The implementation shall document the values of Time_First, Time_Last, Time_Span_First, Time_Span_Last, Time_Span_Unit, and Tick. "),(0,a.kt)("p",null,"Documentation Requirement: The values of Time_First, Time_Last, Time_Span_First, Time_Span_Last, Time_Span_Unit, and Tick for package Real_Time."),(0,a.kt)("p",null,"The implementation shall document the properties of the underlying time base used for the clock and for type Time, such as the range of values supported and any relevant aspects of the underlying hardware or operating system facilities used. "),(0,a.kt)("p",null,"Documentation Requirement: The properties of the underlying time base used in package Real_Time."),(0,a.kt)("p",null,"Discussion: If there is an underlying operating system, this might include information about which system call is used to implement the clock. Otherwise, it might include information about which hardware clock is used. "),(0,a.kt)("p",null,"The implementation shall document whether or not there is any synchronization with external time references, and if such synchronization exists, the sources of synchronization information, the frequency of synchronization, and the synchronization method applied. "),(0,a.kt)("p",null,"Documentation Requirement: Any synchronization of package Real_Time with external time references."),(0,a.kt)("p",null,"{AI05-0299-1} {AI12-0439-1} The implementation shall document any aspects of the external environment that can interfere with the clock behavior as defined in this subclause. "),(0,a.kt)("p",null,"Documentation Requirement: Any aspects of the external environment that can interfere with package Real_Time."),(0,a.kt)("p",null,"Discussion: For example, the implementation is allowed to rely on the time services of an underlying operating system, and this operating system clock can implement time zones or allow the clock to be reset by an operator. This dependence has to be documented. "),(0,a.kt)("h4",{id:"metrics"},"Metrics"),(0,a.kt)("p",null,"{AI05-0299-1} For the purpose of the metrics defined in this subclause, real time is defined to be the International Atomic Time (TAI)."),(0,a.kt)("p",null,"The implementation shall document the following metrics: "),(0,a.kt)("p",null,"An upper bound on the real-time duration of a clock tick. This is a value D such that if t1 and t2 are any real times such that t1 ","<"," t2 and Clockt1 = Clockt2 then t2  t1 ","<","= D."),(0,a.kt)("p",null,"An upper bound on the size of a clock jump."),(0,a.kt)("p",null,"An upper bound on the drift rate of Clock with respect to real time. This is a real number D such that "),(0,a.kt)("p",null,"E",(0,a.kt)("em",{parentName:"p"},"(1D) ","<","= (Clockt+E  Clockt) ","<","= E"),"(1+D)\nprovided that: Clockt + E*(1+D) ","<","= Time_Last."),(0,a.kt)("p",null,"where Clockt is the value of Clock at time t, and E is a real time duration not less than 24 hours. The value of E used for this metric shall be reported. "),(0,a.kt)("p",null,"Reason: This metric is intended to provide a measurement of the long term (cumulative) deviation; therefore, 24 hours is the lower bound on the measurement period. On some implementations, this is also the maximum period, since the language does not require that the range of the type Duration be more than 24 hours. On those implementations that support longer-range Duration, longer measurements should be performed. "),(0,a.kt)("p",null,"An upper bound on the execution time of a call to the Clock function, in processor clock cycles."),(0,a.kt)("p",null,"Upper bounds on the execution times of the operators of the types Time and Time_Span, in processor clock cycles. "),(0,a.kt)("p",null,"Implementation Note: A fast implementation of the Clock function involves repeated reading until you get the same value twice. It is highly improbable that more than three reads will be necessary. Arithmetic on time values should not be significantly slower than 64-bit arithmetic in the underlying machine instruction set. "),(0,a.kt)("p",null,"Documentation Requirement: The metrics for package Real_Time."),(0,a.kt)("h4",{id:"implementation-permissions"},"Implementation Permissions"),(0,a.kt)("p",null,"{AI12-0444-1} Implementations targeted to machines with word size smaller than 32 bits may omit support for the full range and granularity of the Time and Time_Span types. "),(0,a.kt)("p",null,"Discussion: These requirements are based on machines with a word size of 32 bits."),(0,a.kt)("p",null,"Since the range and granularity are implementation defined, the supported values need to be documented. "),(0,a.kt)("h4",{id:"implementation-advice"},"Implementation Advice"),(0,a.kt)("p",null,"When appropriate, implementations should provide configuration mechanisms to change the value of Tick. "),(0,a.kt)("p",null,"Implementation Advice: When appropriate, mechanisms to change the value of Tick should be provided."),(0,a.kt)("p",null,"Reason: This is often needed when the compilation system was originally targeted to a particular processor with a particular interval timer, but the customer uses the same processor with a different interval timer. "),(0,a.kt)("p",null,"Discussion: Tick is a deferred constant and not a named number specifically for this purpose. "),(0,a.kt)("p",null,"Implementation Note: This can be achieved either by pre-run-time configuration tools, or by having Tick be initialized (in the package private part) by a function call residing in a board specific module. "),(0,a.kt)("p",null,"It is recommended that Calendar.Clock and Real_Time.Clock be implemented as transformations of the same time base. "),(0,a.kt)("p",null,"Implementation Advice: Calendar.Clock and Real_Time.Clock should be transformations of the same time base."),(0,a.kt)("p",null,'It is recommended that the "best" time base which exists in the underlying system be available to the application through Clock. "Best" may mean highest accuracy or largest range. '),(0,a.kt)("p",null,'Implementation Advice: The "best" time base which exists in the underlying system should be available to the application through Real_Time.Clock.'),(0,a.kt)("p",null,"NOTE 1   {AI05-0299-1} The rules in this subclause do not imply that the implementation can protect the user from operator or installation errors that can result in the clock being set incorrectly."),(0,a.kt)("p",null,"NOTE 2   Time_Unit is the granularity of the Time type. In contrast, Tick represents the granularity of Real_Time.Clock. There is no requirement that these be the same."),(0,a.kt)("h4",{id:"incompatibilities-with-ada-95"},"Incompatibilities With Ada 95"),(0,a.kt)("p",null,"{AI95-00386-01} {AI05-0005-1} Functions Seconds and Minutes are added to Real_Time. If Real_Time is referenced in a ",(0,a.kt)("a",{parentName:"p",href:"./AA-8.4#S0235"},"use_clause"),", and an entity E with a ",(0,a.kt)("a",{parentName:"p",href:"./AA-3.1#S0022"},"defining_identifier")," of Seconds or Minutes is defined in a package that is also referenced in a ",(0,a.kt)("a",{parentName:"p",href:"./AA-8.4#S0235"},"use_clause"),", the entity E may no longer be use-visible, resulting in errors. This should be rare and is easily fixed if it does occur. "),(0,a.kt)("h4",{id:"wording-changes-from-ada-95"},"Wording Changes from Ada 95"),(0,a.kt)("p",null,"{AI95-00432-01} Added wording explaining how and when many of these functions can raise Constraint_Error. While there always was an intent to raise Constraint_Error if the values did not fit, there never was any wording to that effect, and since Time_Span was a private type, the normal numeric type rules do not apply to it."))}c.isMDXComponent=!0}}]);
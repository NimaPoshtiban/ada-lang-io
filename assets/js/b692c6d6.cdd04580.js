"use strict";(self.webpackChunkada_lang_io=self.webpackChunkada_lang_io||[]).push([[840],{1716:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(6687);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),m=p(a),h=r,f=m["".concat(s,".").concat(h)]||m[h]||d[h]||l;return a?n.createElement(f,i(i({ref:t},c),{},{components:a})):n.createElement(f,i({ref:t},c))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var p=2;p<l;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},8872:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>o,toc:()=>p});var n=a(9440),r=(a(6687),a(1716));const l={sidebar_position:78},i="9.7  Select Statements",o={unversionedId:"arm/AA-9.7",id:"arm/AA-9.7",title:"9.7  Select Statements",description:"There are four forms of the [selectstatement. One form provides a selective wait for one or more selectalternatives. Two provide timed and conditional entry calls. The fourth provides asynchronous transfer of control.]",source:"@site/docs/arm/AA-9.7.md",sourceDirName:"arm",slug:"/arm/AA-9.7",permalink:"/docs/arm/AA-9.7",draft:!1,tags:[],version:"current",sidebarPosition:78,frontMatter:{sidebar_position:78},sidebar:"tutorialSidebar",previous:{title:"9.6  Delay Statements, Duration, and Time",permalink:"/docs/arm/AA-9.6"},next:{title:"9.8  Abort of a Task - Abort of a Sequence of Statements",permalink:"/docs/arm/AA-9.8"}},s={},p=[{value:"Syntax",id:"syntax",level:4},{value:"Examples",id:"examples",level:4},{value:"Extensions to Ada 83",id:"extensions-to-ada-83",level:4},{value:"9.7.1  Selective Accept",id:"971--selective-accept",level:2},{value:"Syntax",id:"syntax-1",level:4},{value:"Legality Rules",id:"legality-rules",level:4},{value:"Dynamic Semantics",id:"dynamic-semantics",level:4},{value:"Examples",id:"examples-1",level:4},{value:"Wording Changes from Ada 83",id:"wording-changes-from-ada-83",level:4},{value:"9.7.2  Timed Entry Calls",id:"972--timed-entry-calls",level:2},{value:"Syntax",id:"syntax-2",level:4},{value:"Legality Rules",id:"legality-rules-1",level:4},{value:"Dynamic Semantics",id:"dynamic-semantics-1",level:4},{value:"Examples",id:"examples-2",level:4},{value:"Wording Changes from Ada 83",id:"wording-changes-from-ada-83-1",level:4},{value:"Incompatibilities With Ada 95",id:"incompatibilities-with-ada-95",level:4},{value:"9.7.3  Conditional Entry Calls",id:"973--conditional-entry-calls",level:2},{value:"Syntax",id:"syntax-3",level:4},{value:"Dynamic Semantics",id:"dynamic-semantics-2",level:4},{value:"Examples",id:"examples-3",level:4},{value:"Wording Changes from Ada 83",id:"wording-changes-from-ada-83-2",level:4},{value:"9.7.4  Asynchronous Transfer of Control",id:"974--asynchronous-transfer-of-control",level:2},{value:"Syntax",id:"syntax-4",level:4},{value:"Dynamic Semantics",id:"dynamic-semantics-3",level:4},{value:"Examples",id:"examples-4",level:4},{value:"Extensions to Ada 83",id:"extensions-to-ada-83-1",level:4},{value:"Extensions to Ada 95",id:"extensions-to-ada-95",level:4}],c={toc:p};function d(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"97--select-statements"},"9.7  Select Statements"),(0,r.kt)("p",null,"[There are four forms of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0269"},"select_statement"),". One form provides a selective wait for one or more ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0272"},"select_alternative"),"s. Two provide timed and conditional entry calls. The fourth provides asynchronous transfer of control.] "),(0,r.kt)("h4",{id:"syntax"},"Syntax"),(0,r.kt)("p",null,"select_statement",(0,r.kt)("a",{id:"S0269"})," ::=\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0270"},"selective_accept"),"\n| ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0276"},"timed_entry_call"),"\n| ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0279"},"conditional_entry_call"),"\n| ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0280"},"asynchronous_select")),(0,r.kt)("h4",{id:"examples"},"Examples"),(0,r.kt)("p",null,"Example of a select statement: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ada"},"select\n   accept Driver_Awake_Signal;\nor\n   delay 30.0*Seconds;\n   Stop_The_Train;\nend select;\n\n")),(0,r.kt)("h4",{id:"extensions-to-ada-83"},"Extensions to Ada 83"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0280"},"Asynchronous_select")," is new. "),(0,r.kt)("h2",{id:"971--selective-accept"},"9.7.1  Selective Accept"),(0,r.kt)("p",null,"[This form of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0269"},"select_statement")," allows a combination of waiting for, and selecting from, one or more alternatives. The selection may depend on conditions associated with each alternative of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0270"},"selective_accept"),". ]"),(0,r.kt)("h4",{id:"syntax-1"},"Syntax"),(0,r.kt)("p",null,"selective_accept",(0,r.kt)("a",{id:"S0270"})," ::=\nselect\n","[[guard](./AA-9.7#S0271)][select_alternative]","(./AA-9.7#S0272)\n{ or\n","[[guard](./AA-9.7#S0271)][select_alternative]","(./AA-9.7#S0272) }\n[ else\n",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," ]\nend select;"),(0,r.kt)("p",null,"guard",(0,r.kt)("a",{id:"S0271"})," ::= when ",(0,r.kt)("a",{parentName:"p",href:"./AA-4.5#S0150"},"condition")," =",">"),(0,r.kt)("p",null,"select_alternative",(0,r.kt)("a",{id:"S0272"})," ::=\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0273"},"accept_alternative"),"\n| ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative"),"\n| ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0275"},"terminate_alternative")),(0,r.kt)("p",null,"accept_alternative",(0,r.kt)("a",{id:"S0273"})," ::=\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.5#S0258"},"accept_statement")," [",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements"),"]"),(0,r.kt)("p",null,"delay_alternative",(0,r.kt)("a",{id:"S0274"})," ::=\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.6#S0266"},"delay_statement")," [",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements"),"]"),(0,r.kt)("p",null,"terminate_alternative",(0,r.kt)("a",{id:"S0275"})," ::= terminate;"),(0,r.kt)("p",null,"A ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0270"},"selective_accept")," shall contain at least one ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0273"},"accept_alternative"),". In addition, it can contain: "),(0,r.kt)("p",null,"a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0275"},"terminate_alternative")," (only one); or"),(0,r.kt)("p",null,"one or more ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative"),"s; or"),(0,r.kt)("p",null,"an else part (the reserved word else followed by a ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements"),"). "),(0,r.kt)("p",null,"These three possibilities are mutually exclusive. "),(0,r.kt)("h4",{id:"legality-rules"},"Legality Rules"),(0,r.kt)("p",null,"If a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0270"},"selective_accept")," contains more than one ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative"),", then all shall be ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.6#S0268"},"delay_relative_statement"),"s, or all shall be ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.6#S0267"},"delay_until_statement"),"s for the same time type. "),(0,r.kt)("p",null,"Reason: This simplifies the implementation and the description of the semantics. "),(0,r.kt)("h4",{id:"dynamic-semantics"},"Dynamic Semantics"),(0,r.kt)("p",null,"A ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0272"},"select_alternative")," is said to be open if it is not immediately preceded by a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0271"},"guard"),", or if the ",(0,r.kt)("a",{parentName:"p",href:"./AA-4.5#S0150"},"condition")," of its ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0271"},"guard")," evaluates to True. It is said to be closed otherwise."),(0,r.kt)("p",null,"For the execution of a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0270"},"selective_accept"),", any ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0271"},"guard")," ",(0,r.kt)("a",{parentName:"p",href:"./AA-4.5#S0150"},"condition"),"s are evaluated; open alternatives are thus determined. For an open ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative"),", the delay",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"./AA-4.4#S0132"},"expression")," is also evaluated. Similarly, for an open ",(0,r.kt)("a",{parentName:"em",href:"./AA-9.7#S0273"},"accept_alternative")," for an entry of a family, the ",(0,r.kt)("a",{parentName:"em",href:"./AA-9.5#S0259"},"entry_index")," is also evaluated. These evaluations are performed in an arbitrary order, except that a delay"),(0,r.kt)("a",{parentName:"p",href:"./AA-4.4#S0132"},"expression")," or ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.5#S0259"},"entry_index")," is not evaluated until after evaluating the corresponding ",(0,r.kt)("a",{parentName:"p",href:"./AA-4.5#S0150"},"condition"),", if any. Selection and execution of one open alternative, or of the else part, then completes the execution of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0270"},"selective_accept"),"; the rules for this selection are described below."),(0,r.kt)("p",null,"Open ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0273"},"accept_alternative"),"s are first considered. Selection of one such alternative takes place immediately if the corresponding entry already has queued calls. If several alternatives can thus be selected, one of them is selected according to the entry queuing policy in effect (see 9.5.3 and D.4). When such an alternative is selected, the selected call is removed from its entry queue and the ",(0,r.kt)("a",{parentName:"p",href:"./AA-11.2#S0304"},"handled_sequence_of_statements")," (if any) of the corresponding ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.5#S0258"},"accept_statement")," is executed; after the rendezvous completes any subsequent ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," of the alternative is executed. If no selection is immediately possible (in the above sense) and there is no else part, the task blocks until an open alternative can be selected."),(0,r.kt)("p",null,"Selection of the other forms of alternative or of an else part is performed as follows: "),(0,r.kt)("p",null,"An open ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative")," is selected when its expiration time is reached if no ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0273"},"accept_alternative")," or other ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative")," can be selected prior to the expiration time. If several ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative"),"s have this same expiration time, one of them is selected according to the queuing policy in effect (see D.4); the default queuing policy chooses arbitrarily among the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative"),"s whose expiration time has passed."),(0,r.kt)("p",null,"The else part is selected and its ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," is executed if no ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0273"},"accept_alternative")," can immediately be selected; in particular, if all alternatives are closed."),(0,r.kt)("p",null,"{AI05-0299-1} An open ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0275"},"terminate_alternative")," is selected if the conditions stated at the end of subclause 9.3 are satisfied. "),(0,r.kt)("p",null,"Ramification: In the absence of a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.5#S0265"},"requeue_statement"),", the conditions stated are such that a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0275"},"terminate_alternative")," cannot be selected while there is a queued entry call for any entry of the task. In the presence of requeues from a task to one of its subtasks, it is possible that when a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0275"},"terminate_alternative")," of the subtask is selected, requeued calls (for closed entries only) might still be queued on some entry of the subtask. Tasking_Error will be propagated to such callers, as is usual when a task completes while queued callers remain. "),(0,r.kt)("p",null,"The exception Program_Error is raised if all alternatives are closed and there is no else part."),(0,r.kt)("p",null,"NOTE 1   A ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0270"},"selective_accept")," is allowed to have several open ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative"),"s. A ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0270"},"selective_accept")," is allowed to have several open ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0273"},"accept_alternative"),"s for the same entry."),(0,r.kt)("h4",{id:"examples-1"},"Examples"),(0,r.kt)("p",null,"Example of a task body with a selective accept: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ada"},"task body Server is\n   Current_Work_Item : Work_Item;\nbegin\n   loop\n      select\n         accept Next_Work_Item(WI : in Work_Item) do\n            Current_Work_Item := WI;\n         end;\n         Process_Work_Item(Current_Work_Item);\n      or\n         accept Shut_Down;\n         exit;       -- Premature shut down requested\n      or\n         terminate;  -- Normal shutdown at end of scope\n      end select;\n   end loop;\nend Server;\n\n")),(0,r.kt)("h4",{id:"wording-changes-from-ada-83"},"Wording Changes from Ada 83"),(0,r.kt)("p",null,"The name of selective_wait was changed to ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0270"},"selective_accept")," to better describe what is being waited for. We kept ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0272"},"select_alternative")," as is, because selective_accept_alternative was too easily confused with ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0273"},"accept_alternative"),". "),(0,r.kt)("h2",{id:"972--timed-entry-calls"},"9.7.2  Timed Entry Calls"),(0,r.kt)("p",null,"{AI95-00345-01} {AI12-0439-1} [A ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0276"},"timed_entry_call")," issues an entry call that is cancelled if the call (or a requeue-with-abort of the call) is not selected before the expiration time is reached. A procedure call may appear rather than an entry call for cases where the procedure can be implemented by an entry. ]"),(0,r.kt)("h4",{id:"syntax-2"},"Syntax"),(0,r.kt)("p",null,"timed_entry_call",(0,r.kt)("a",{id:"S0276"})," ::=\nselect\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0277"},"entry_call_alternative"),"\nor\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative"),"\nend select;"),(0,r.kt)("p",null,"{AI95-00345-01} entry_call_alternative",(0,r.kt)("a",{id:"S0277"})," ::=\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0278"},"procedure_or_entry_call")," [",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements"),"]"),(0,r.kt)("p",null,"{AI95-00345-01} procedure_or_entry_call",(0,r.kt)("a",{id:"S0278"})," ::=\n",(0,r.kt)("a",{parentName:"p",href:"./AA-6.4#S0217"},"procedure_call_statement")," | ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.5#S0264"},"entry_call_statement")),(0,r.kt)("h4",{id:"legality-rules-1"},"Legality Rules"),(0,r.kt)("p",null,"{AI95-00345-01} If a ",(0,r.kt)("a",{parentName:"p",href:"./AA-6.4#S0217"},"procedure_call_statement")," is used for a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0278"},"procedure_or_entry_call"),", the procedure",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"./AA-4.1#S0091"},"name")," or procedure"),(0,r.kt)("a",{parentName:"p",href:"./AA-4.1#S0093"},"prefix")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-6.4#S0217"},"procedure_call_statement")," shall statically denote an entry renamed as a procedure or (a view of) a primitive subprogram of a limited interface whose first parameter is a controlling parameter (see 3.9.2). "),(0,r.kt)("p",null,"Reason: This would be a confusing way to call a procedure, so we only allow it when it is possible that the procedure is actually an entry. We could have allowed formal subprograms here, but we didn't because we'd have to allow all formal subprograms, and it would increase the difficulty of generic code sharing."),(0,r.kt)("p",null,'We say "statically denotes" because an access-to-subprogram cannot be primitive, and we don\'t have anything like access-to-entry. So only names of entries or procedures are possible. '),(0,r.kt)("h4",{id:"dynamic-semantics-1"},"Dynamic Semantics"),(0,r.kt)("p",null,"{AI95-00345-01} For the execution of a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0276"},"timed_entry_call"),", the entry",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"./AA-4.1#S0091"},"name"),", procedure"),(0,r.kt)("a",{parentName:"p",href:"./AA-4.1#S0091"},"name"),", or procedure",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"./AA-4.1#S0093"},"prefix"),", and any actual parameters are evaluated, as for a simple entry call (see 9.5.3) or procedure call (see 6.4). The expiration time (see 9.6) for the call is determined by evaluating the delay"),(0,r.kt)("a",{parentName:"p",href:"./AA-4.4#S0132"},"expression")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative"),". If the call is an entry call or a call on a procedure implemented by an entry, the entry call is then issued. Otherwise, the call proceeds as described in 6.4 for a procedure call, followed by the ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0277"},"entry_call_alternative"),"; the ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative")," is ignored."),(0,r.kt)("p",null,"If the call is queued (including due to a requeue-with-abort), and not selected before the expiration time is reached, an attempt to cancel the call is made. If the call completes due to the cancellation, the optional ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative")," is executed; if the entry call completes normally, the optional ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0277"},"entry_call_alternative")," is executed. "),(0,r.kt)("p",null,"This paragraph was deleted.{AI95-00345-01} "),(0,r.kt)("h4",{id:"examples-2"},"Examples"),(0,r.kt)("p",null,"Example of a timed entry call: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ada"},"select\n   Controller.Request(Medium)(Some_Item);\nor\n   delay 45.0;\n   --  controller too busy, try something else\nend select;\n\n")),(0,r.kt)("h4",{id:"wording-changes-from-ada-83-1"},"Wording Changes from Ada 83"),(0,r.kt)("p",null,"{AI05-0299-1} This subclause comes before the one for Conditional Entry Calls, so we can define conditional entry calls in terms of timed entry calls. "),(0,r.kt)("h4",{id:"incompatibilities-with-ada-95"},"Incompatibilities With Ada 95"),(0,r.kt)("p",null,"{AI95-00345-01} {AI05-0005-1} A procedure call can be used as the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0277"},"entry_call_alternative")," in a timed or conditional entry call, if the procedure might actually be an entry. Since the fact that something is an entry could be used in resolving these calls in Ada 95, it is possible for timed or conditional entry calls that resolved in Ada 95 to be ambiguous in Ada 2005. That could happen if both an entry and procedure with the same name and profile exist, which should be rare. "),(0,r.kt)("h2",{id:"973--conditional-entry-calls"},"9.7.3  Conditional Entry Calls"),(0,r.kt)("p",null,"{AI95-00345-01} {AI12-0439-1} [A ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0279"},"conditional_entry_call")," issues an entry call that is then cancelled if it is not selected immediately (or if a requeue-with-abort of the call is not selected immediately). A procedure call may appear rather than an entry call for cases where the procedure can be implemented by an entry.] "),(0,r.kt)("p",null,"To be honest: In the case of an entry call on a protected object, it is OK if the entry is closed at the start of the corresponding protected action, so long as it opens and the call is selected before the end of that protected action (due to changes in the Count attribute). "),(0,r.kt)("h4",{id:"syntax-3"},"Syntax"),(0,r.kt)("p",null,"conditional_entry_call",(0,r.kt)("a",{id:"S0279"})," ::=\nselect\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0277"},"entry_call_alternative"),"\nelse\n",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements"),"\nend select;"),(0,r.kt)("h4",{id:"dynamic-semantics-2"},"Dynamic Semantics"),(0,r.kt)("p",null,"The execution of a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0279"},"conditional_entry_call")," is defined to be equivalent to the execution of a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0276"},"timed_entry_call")," with a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0274"},"delay_alternative")," specifying an immediate expiration time and the same ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," as given after the reserved word else. "),(0,r.kt)("p",null,"NOTE 1   {AI12-0440-1} A ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0279"},"conditional_entry_call")," can briefly increase the Count attribute of the entry, even if the conditional call is not selected."),(0,r.kt)("h4",{id:"examples-3"},"Examples"),(0,r.kt)("p",null,"Example of a conditional entry call: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ada"},"{AI12-0178-1} procedure Spin(R : in out Resource) is  -- see 9.4\nbegin\n   loop\n      select\n         R.Seize;\n         return;\n      else\n         null;  --  busy waiting\n      end select;\n   end loop;\nend;\n\n")),(0,r.kt)("h4",{id:"wording-changes-from-ada-83-2"},"Wording Changes from Ada 83"),(0,r.kt)("p",null,'{AI05-0299-1} This subclause comes after the one for Timed Entry Calls, so we can define conditional entry calls in terms of timed entry calls. We do that so that an "expiration time" is defined for both, thereby simplifying the definition of what happens on a requeue-with-abort. '),(0,r.kt)("h2",{id:"974--asynchronous-transfer-of-control"},"9.7.4  Asynchronous Transfer of Control"),(0,r.kt)("p",null,"[An asynchronous ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0269"},"select_statement")," provides asynchronous transfer of control upon completion of an entry call or the expiration of a delay.] "),(0,r.kt)("h4",{id:"syntax-4"},"Syntax"),(0,r.kt)("p",null,"asynchronous_select",(0,r.kt)("a",{id:"S0280"})," ::=\nselect\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0281"},"triggering_alternative"),"\nthen abort\n",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part"),"\nend select;"),(0,r.kt)("p",null,"triggering_alternative",(0,r.kt)("a",{id:"S0281"})," ::= ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0282"},"triggering_statement")," [",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements"),"]"),(0,r.kt)("p",null,"{AI95-00345-01} triggering_statement",(0,r.kt)("a",{id:"S0282"})," ::= ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0278"},"procedure_or_entry_call")," | ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.6#S0266"},"delay_statement")),(0,r.kt)("p",null,"abortable_part",(0,r.kt)("a",{id:"S0283"})," ::= ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")),(0,r.kt)("h4",{id:"dynamic-semantics-3"},"Dynamic Semantics"),(0,r.kt)("p",null,"{AI95-00345-01} For the execution of an ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0280"},"asynchronous_select")," whose ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0282"},"triggering_statement")," is a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0278"},"procedure_or_entry_call"),", the entry",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"./AA-4.1#S0091"},"name"),", procedure"),(0,r.kt)("a",{parentName:"p",href:"./AA-4.1#S0091"},"name"),", or procedure_",(0,r.kt)("a",{parentName:"p",href:"./AA-4.1#S0093"},"prefix"),", and actual parameters are evaluated as for a simple entry call (see 9.5.3) or procedure call (see 6.4). If the call is an entry call or a call on a procedure implemented by an entry, the entry call is issued. If the entry call is queued (or requeued-with-abort), then the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part")," is executed. [If the entry call is selected immediately, and never requeued-with-abort, then the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part")," is never started.] If the call is on a procedure that is not implemented by an entry, the call proceeds as described in 6.4, followed by the ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0281"},"triggering_alternative"),"[; the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part")," is never started]."),(0,r.kt)("p",null,"For the execution of an ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0280"},"asynchronous_select")," whose ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0282"},"triggering_statement")," is a ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.6#S0266"},"delay_statement"),", the delay_",(0,r.kt)("a",{parentName:"p",href:"./AA-4.4#S0132"},"expression")," is evaluated and the expiration time is determined, as for a normal ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.6#S0266"},"delay_statement"),". If the expiration time has not already passed, the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part")," is executed."),(0,r.kt)("p",null,"If the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part")," completes and is left prior to completion of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0282"},"triggering_statement"),", an attempt to cancel the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0282"},"triggering_statement")," is made. If the attempt to cancel succeeds (see 9.5.3 and 9.6), the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0280"},"asynchronous_select")," is complete."),(0,r.kt)("p",null,"If the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0282"},"triggering_statement")," completes other than due to cancellation, the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part")," is aborted (if started but not yet completed - see 9.8). If the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0282"},"triggering_statement")," completes normally, the optional ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0281"},"triggering_alternative")," is executed after the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part")," is left. "),(0,r.kt)("p",null,"Discussion: We currently don't specify when the by-copy ","[in]"," out parameters are assigned back into the actuals. We considered requiring that to happen after the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part")," is left. However, that doesn't seem useful enough to justify possibly overspecifying the implementation approach, since some of the parameters are passed by reference anyway."),(0,r.kt)("p",null,"In an earlier description, we required that the ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0281"},"triggering_alternative")," execute after aborting the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part"),", but before waiting for it to complete and finalize, to provide more rapid response to the triggering event in case the finalization was unbounded. However, various reviewers felt that this created unnecessary complexity in the description, and a potential for undesirable concurrency (and nondeterminism) within a single task. We have now reverted to simpler, more deterministic semantics, but anticipate that further discussion of this issue might be appropriate during subsequent reviews. One possibility is to leave this area implementation defined, so as to encourage experimentation. The user would then have to assume the worst about what kinds of actions are appropriate for the ",(0,r.kt)("a",{parentName:"p",href:"./AA-5.1#S0166"},"sequence_of_statements")," of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0281"},"triggering_alternative")," to achieve portability. "),(0,r.kt)("h4",{id:"examples-4"},"Examples"),(0,r.kt)("p",null,"Example of a main command loop for a command interpreter: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ada"},'loop\n   select\n      Terminal.Wait_For_Interrupt;\n      Put_Line("Interrupted");\n   then abort\n      -- This will be abandoned upon terminal interrupt\n      Put_Line("-&gt ");\n      Get_Line(Command, Last);\n      Process_Command(Command(1..Last));\n   end select;\nend loop;\n\n')),(0,r.kt)("p",null,"Example of a time-limited calculation: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ada"},'{AI12-0442-1} select\n   delay 5.0;\n   Put_Line("Calculation does not converge");\nthen abort\n   -- This calculation is expected to finish in 5.0 seconds;\n   --  if not, it is assumed to diverge.\n   Horribly_Complicated_Recursive_Function(X, Y);\nend select;\n\n')),(0,r.kt)("p",null,"{AI12-0098-1} {AI12-0418-1} Note that these examples presume that there are abort completion points (see 9.8) within the execution of the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0283"},"abortable_part"),". "),(0,r.kt)("h4",{id:"extensions-to-ada-83-1"},"Extensions to Ada 83"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0280"},"Asynchronous_select")," is new. "),(0,r.kt)("h4",{id:"extensions-to-ada-95"},"Extensions to Ada 95"),(0,r.kt)("p",null,"{AI95-00345-01} A procedure can be used as the ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0282"},"triggering_statement")," of an ",(0,r.kt)("a",{parentName:"p",href:"./AA-9.7#S0280"},"asynchronous_select"),", if the procedure might actually be an entry."))}d.isMDXComponent=!0}}]);